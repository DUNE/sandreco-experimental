//
// Created by paolo on 08/05/2025.
//

#include <ufw/factory.hpp>

#include <edep_reader/edep_reader.hpp>

#include "fake_reco.hpp"

namespace sand::fake_reco {
  fake_reco::fake_reco(): process{{}, {}} {
    UFW_DEBUG("fake_reco process created");
  }

  void fake_reco::run() {
    const auto &inputTree = get<edep_reader>();

    std::size_t childrenTrajectoriesCount = inputTree.GetChildrenTrajectories().size();

    UFW_INFO("------------------------------");

    UFW_INFO("Reading root trajectory with id: {}", inputTree.GetId());
    UFW_INFO("Children trajectories foud: {}", childrenTrajectoriesCount);

    for (int i = 0; i < childrenTrajectoriesCount; ++i) {
      const auto& childTrajectory = inputTree.GetChildrenTrajectories()[i];
      UFW_INFO("---------------");
      UFW_INFO("Parsing children trajectory number {}", i);

      UFW_INFO("Children trajectory id: {}", childTrajectory.GetId());
      UFW_INFO("Interaction nuber: {}", childTrajectory.GetInteractionNumber());
      UFW_INFO("Reaction generated by the child trajectory: {}", childTrajectory.GetReaction());
    }

    UFW_INFO("------------------------------");
  }
} // namespace sand::fake_reco

UFW_REGISTER_DYNAMIC_PROCESS_FACTORY(sand::fake_reco::fake_reco);
